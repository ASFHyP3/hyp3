OPERA_RTC_S1:
  required_parameters:
    - granules
  parameters:
    granules:
      api_schema:
        type: array
        minItems: 1
        maxItems: 1
        example:
          - S1_073251_IW2_20200128T020712_VV_2944-BURST
        items:
          anyOf:
            - description: Sentinel-1 co-pol IW burst granule to process.
              type: string
              pattern: '^S1_\d{6}_IW\d_\d{8}T\d{6}_(VV|HH)_[\dA-F]{4}-BURST$'
              minLength: 43
              maxLength: 43
              example: S1_073251_IW2_20200128T020712_VV_2944-BURST
  cost_profiles:
    # TODO integration test?
    EDC:
      cost: 1.0 # TODO
    DEFAULT:
      cost: 1.0
  validators:
    - check_opera_rtc_s1_date
    - check_dem_coverage
    - check_opera_rtc_s1_static_coverage
  steps:
    - name: ''
      image: 845172464411.dkr.ecr.us-west-2.amazonaws.com/asfhyp3/hyp3-opera-rtc
      command:
        - Ref::granules
        - --bucket
        - '!Ref Bucket'
        - --bucket-prefix
        - Ref::job_id
      timeout: 28800 # 8 hr # TODO reduce after cost estimate
      compute_environment: Default
      # TODO: consider setting vcpu/memory to less; may be able to use 4 or 2 GiB of memory
      vcpu: 1
      memory: 7500
      secrets:
        - EARTHDATA_USERNAME
        - EARTHDATA_PASSWORD
