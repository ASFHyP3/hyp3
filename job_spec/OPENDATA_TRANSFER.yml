OPENDATA_TRANSFER:
  required_parameters:
    - granule
    - bucket
  parameters:
    granule:
      api_schema:
        type: array
        minItems: 1
        maxItems: 1
        example:
          - S1A_IW_SLC__1SSV_20150621T120220_20150621T120232_006471_008934_72D8
        items:
          anyOf:
            - description: The name of the Sentinel-1 SLC granule to transfer
              type: string
              pattern: "^S1[ABC]_IW_SLC__1S[SD][VH]"
              minLength: 67
              maxLength: 67
              example: S1A_IW_SLC__1SSV_20150621T120220_20150621T120232_006471_008934_72D8
        default: ""
    bucket:
      api_schema:
        description: Publish the resulting product to the AWS Open Data (or test) S3 Bucket
        type: string
        nullable: true
        enum:
          - null
          - "" # FIXME:
          - "" # FIXME:
        default: null
  cost_profiles:
    DEFAULT:
      cost: 1.0
  validators: []
  steps:
    - name: 'AWS OpenData Transfer'
      image: ghcr.io/asfhyp3/hyp3-sentinel1-opendata
      command:
        - Ref::granule
        - --bucket
        - Ref::bucket
      timeout: 21600
      compute_environment: Default
      vcpu: 1
      memory: 16000
      secrets:
        - EARTHDATA_USERNAME
        - EARTHDATA_PASSWORD
