OPERA_DISP_TMS:
  required_parameters:
    - measurement_type
    - frames
    - start_date
    - end_date
  parameters:
    measurement_type:
      api_schema:
        description: Data measurement to visualize
        type: string
        enum:
          - displacement
          - secant_velocity
          - velocity
        example: displacement
    frames:
      api_schema:
        description: List of frame IDs to include in mosaic
        type: array
        minItems: 1
        # TODO
        #maxItems:
        example:
          - 11113
          - 11114
          - 11115
        items:
          description: Frame ID
          type: integer
          minimum: 1
          maximum: 46986
          example: 11113
    start_date:
      api_schema:
        description: Start of secondary date range for which to generate a tile map (%Y%m%d)
        type: string
        pattern: "^\\d{8}$"
        minLength: 8
        maxLength: 8
        example: 20140101
    end_date:
      api_schema:
        description: End of secondary date range for which to generate a tile map (%Y%m%d)
        type: string
        pattern: "^\\d{8}$"
        minLength: 8
        maxLength: 8
        example: 20260101
  cost_profiles:
    EDC:
      # TODO should we be concerned about exposing this job type via EDC UAT with a cost of 1?
      cost: 1.0
    DEFAULT:
      cost: 1.0
  validators: []
  steps:
    - name: ''
      image: ghcr.io/asfhyp3/opera-disp-tms
      # TODO: remove image_tag
      image_tag: 0.6.1.dev23_gcff6175
      command:
        - Ref::measurement_type
        - Ref::frames
        - Ref::start_date
        - Ref::end_date
        - --bucket
        - '!Ref Bucket'
        - --bucket-prefix
        - Ref::bucket_prefix
      # TODO determine timeout
      timeout: 86400 # 24 hr
      compute_environment: Default
      vcpu: 1
      memory: 31500
      secrets:
        - EARTHDATA_USERNAME
        - EARTHDATA_PASSWORD
