WATER_MAP:
  required_parameters:
    - wm_raster
  parameters:
    bucket_prefix:
      default:  '""'
    flood_depth_estimator:
      api_schema:
        description: Flood depth estimation approach. A value of None indicates that flood depth estimation will not be performed.
        default: iterative
        type: string
        enum:
          - iterative
          - logstat
          - nmad
          - numpy
          - None
    water_level_sigma:
      api_schema:
        description: Standard deviation to estimate max water height for each object. Ignored when flood_depth_estimator is None.
        default: 3.0
        type: number
    known_water_threshold:
      api_schema:
        description: Threshold for extracting known water area in percent. Ignored when flood_depth_estimator is None.
        default: 30.0
        type: number
    iterative_min:
      api_schema:
        description: Minimum bound used for iterative method. Ignored when flood_depth_estimator is None.
        default: 0
        type: integer
    iterative_max:
      api_schema:
        description: Maximum bound used for iterative method. Ignored when flood_depth_estimator is None.
        default: 15
        type: integer
    wm_raster:
      api_schema:
        description: WM vsicurl
        type: string
  validators: []
  tasks:
    - name: FLOOD_MAP
      image: ghcr.io/asfhyp3/asf-tools
      command:
        - ++process
        - flood_map
        - --bucket
        - '!Ref Bucket'
        - --bucket-prefix
        - Ref::bucket_prefix
        - --estimator
        - Ref::flood_depth_estimator
        - --water-level-sigma
        - Ref::water_level_sigma
        - --known-water-threshold
        - Ref::known_water_threshold
        - --iterative-min
        - Ref::iterative_min
        - --iterative-max
        - Ref::iterative_max
        - --wm-raster
        - Ref::wm_raster
      timeout: 86400
      vcpu: 1
      memory: 126000
